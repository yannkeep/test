<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AUDERGHEM OS | CIVIC CORE v1.0</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.3/dist/cdn.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        'void': '#030712',
                        'glass': 'rgba(255, 255, 255, 0.03)',
                        'glass-border': 'rgba(255, 255, 255, 0.08)',
                        'neon-red': '#FF2A2A',
                        'neon-green': '#00FF94',
                        'neon-blue': '#00D1FF',
                    },
                    animation: {
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'scan': 'scan 8s linear infinite',
                    },
                    keyframes: {
                        scan: {
                            '0%': { transform: 'translateY(-100%)' },
                            '100%': { transform: 'translateY(100%)' }
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* CSS AVANCÉ POUR L'IMMERSION */
        body { background-color: #030712; color: #E2E8F0; overflow: hidden; }
        
        .glass-panel {
            background: rgba(17, 24, 39, 0.7);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        .crt-overlay {
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            background-size: 100% 2px, 3px 100%;
            pointer-events: none;
        }

        /* Barre de progression quadratique */
        input[type=range] {
            -webkit-appearance: none;
            background: transparent;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 16px; width: 16px;
            border-radius: 50%;
            background: #ffffff;
            cursor: pointer;
            margin-top: -6px;
            box-shadow: 0 0 10px rgba(255,255,255,0.8);
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%; height: 4px;
            background: rgba(255,255,255,0.2);
            border-radius: 2px;
        }
    </style>
</head>

<body x-data="auderghemCore()" x-init="bootSystem()" class="antialiased selection:bg-neon-red selection:text-white">

    <div class="fixed inset-0 z-0">
        <div class="absolute inset-0 bg-[url('https://cartodb-basemaps-a.global.ssl.fastly.net/dark_all/14/8394/5472.png')] bg-cover bg-center opacity-40 grayscale"></div>
        <div class="absolute inset-0 bg-gradient-to-t from-void via-void/80 to-transparent"></div>
        <div class="crt-overlay absolute inset-0 z-50 opacity-20"></div>
    </div>

    <div x-show="!authenticated" 
         x-transition:leave="transition ease-[cubic-bezier(0.68,-0.55,0.27,1.55)] duration-1000"
         x-transition:leave-start="opacity-100 blur-0 scale-100"
         x-transition:leave-end="opacity-0 blur-xl scale-110"
         class="fixed inset-0 z-50 flex items-center justify-center backdrop-blur-md bg-void/60">
        
        <div class="text-center space-y-12 relative">
            <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-neon-red/20 rounded-full blur-[100px] animate-pulse-slow"></div>
            
            <div class="relative z-10">
                <h1 class="text-6xl font-black tracking-tighter mb-2">AUDERGHEM <span class="text-neon-red">OS</span></h1>
                <p class="text-sm font-mono text-gray-400 tracking-[0.3em]">SYSTÈME D'EXPLOITATION CITOYEN</p>
            </div>

            <button @click="login()" 
                    class="group relative inline-flex items-center justify-center px-8 py-4 font-mono font-bold text-white transition-all duration-200 bg-transparent border border-white/20 rounded-none hover:bg-white/5 hover:border-neon-red/50 hover:shadow-[0_0_30px_rgba(255,42,42,0.4)]">
                <span class="mr-3 text-xl"><i class="ph ph-fingerprint"></i></span>
                <span x-text="loginState">INITIALISER LE POD</span>
                <div class="absolute inset-0 border border-white/0 group-hover:border-neon-red/30 scale-105 transition-all duration-500 opacity-0 group-hover:opacity-100"></div>
            </button>

            <div class="text-xs text-gray-600 font-mono mt-8">
                <p>SECURED BY SOLID PROTOCOL • NO CENTRAL DATABASE</p>
                <p class="mt-1">NODE: 1160-HERRMANN-DEBROUX</p>
            </div>
        </div>
    </div>

    <main x-show="authenticated" x-cloak class="relative z-10 container mx-auto h-screen p-6 grid grid-cols-12 grid-rows-12 gap-6 pt-12">
        
        <header class="col-span-12 row-span-1 flex justify-between items-center glass-panel px-6 rounded-lg animate-[slideDown_0.8s_ease-out]">
            <div class="flex items-center gap-4">
                <div class="w-2 h-2 bg-neon-green rounded-full shadow-[0_0_10px_#00FF94] animate-pulse"></div>
                <span class="font-mono text-sm text-neon-green">SYSTEM_ONLINE</span>
                <span class="font-mono text-sm text-gray-500">|</span>
                <span class="font-mono text-sm text-white">CITOYEN.SOLID/WEBID#ME</span>
            </div>
            <div class="flex items-center gap-6">
                <div class="text-right">
                    <p class="text-xs text-gray-400 font-mono">CRÉDITS DE VOIX</p>
                    <p class="text-xl font-bold text-white tracking-widest"><span x-text="credits" class="text-neon-blue">100</span> CP</p>
                </div>
                <button class="p-2 hover:bg-white/10 rounded-full transition"><i class="ph ph-gear text-xl"></i></button>
            </div>
        </header>

        <div class="col-span-8 row-span-6 glass-panel p-6 rounded-2xl relative overflow-hidden group">
            <div class="absolute top-0 right-0 p-4 opacity-30 group-hover:opacity-100 transition duration-500">
                <i class="ph ph-arrows-left-right text-4xl text-neon-red"></i>
            </div>
            
            <div class="flex justify-between items-end mb-6">
                <div>
                    <h2 class="text-2xl font-bold text-white flex items-center gap-3">
                        <i class="ph ph-train text-neon-blue"></i>
                        FLUX DE MOBILITÉ
                    </h2>
                    <p class="text-sm text-gray-400 font-mono mt-1">CROSS-REFERENCE: STIB (OFFICIEL) vs TELRAAM (CITOYEN)</p>
                </div>
            </div>

            <div class="h-[65%] w-full">
                <canvas id="mobilityChart"></canvas>
            </div>

            <div class="mt-4 flex gap-4">
                <div class="px-3 py-1 bg-neon-red/10 border border-neon-red/20 rounded text-xs font-mono text-neon-red">
                    ⚠️ DIVERGENCE DÉTECTÉE: +12%
                </div>
                <div class="px-3 py-1 bg-neon-blue/10 border border-neon-blue/20 rounded text-xs font-mono text-neon-blue">
                    LIVE FEED: ACTIVE
                </div>
            </div>
        </div>

        <div class="col-span-4 row-span-6 glass-panel rounded-2xl flex flex-col overflow-hidden border-l-4 border-l-neon-green">
            <div class="p-5 border-b border-white/5 bg-white/5">
                <h3 class="font-bold text-white flex items-center gap-2">
                    <i class="ph ph-heartbeat text-neon-green"></i>
                    SOCIAL-SANTÉ BRIDGE
                </h3>
                <p class="text-xs text-gray-400 font-mono">STANDARD FHIR R4</p>
            </div>
            
            <div class="flex-1 bg-[#0D1117] p-4 font-mono text-xs overflow-y-auto relative">
                <div class="absolute inset-0 bg-gradient-to-b from-transparent via-neon-green/5 to-transparent h-[20%] w-full animate-scan pointer-events-none"></div>
                
                <div class="space-y-2">
                    <div class="flex justify-between text-gray-500">
                        <span>> GET /HealthcareService/CPAS-1160</span>
                        <span class="text-neon-green">200 OK</span>
                    </div>
                    <pre class="text-gray-300 leading-relaxed">
{
  <span class="text-purple-400">"resourceType"</span>: "HealthcareService",
  <span class="text-purple-400">"id"</span>: "aide-repas-domicile",
  <span class="text-purple-400">"providedBy"</span>: {
    "display": "CPAS Auderghem"
  },
  <span class="text-purple-400">"eligibility"</span>: [
    {
      <span class="text-purple-400">"code"</span>: "resident-status",
      <span class="text-purple-400">"status"</span>: <span class="text-neon-green">true</span> <span class="text-gray-600">// Verified via Solid</span>
    }
  ]
}</pre>
                </div>
            </div>
            
            <div class="p-4 bg-neon-green/10">
                <button class="w-full py-2 bg-neon-green text-black font-bold text-xs font-mono uppercase hover:bg-white transition">
                    Générer Prescription Sociale
                </button>
            </div>
        </div>

        <div class="col-span-8 row-span-5 glass-panel p-6 rounded-2xl">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold flex items-center gap-2">
                    <i class="ph ph-scales text-purple-400"></i>
                    BUDGET PARTAGÉ : VOTE QUADRATIQUE
                </h3>
                <div class="text-xs font-mono text-gray-400">FORMULE: COÛT = VOIX²</div>
            </div>

            <div class="space-y-8">
                <div class="group">
                    <div class="flex justify-between mb-2">
                        <span class="font-medium text-white">Rénovation Espace Insectes (Athénée)</span>
                        <span class="font-mono text-purple-300">Coût: <span x-text="Math.pow(votes.p1, 2)"></span> crédits</span>
                    </div>
                    <div class="flex items-center gap-4">
                        <input type="range" min="0" max="10" step="1" x-model="votes.p1" @input="checkCredits('p1')" class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer">
                        <div class="w-12 h-12 flex items-center justify-center bg-purple-500/20 border border-purple-500 rounded-lg text-purple-300 font-bold text-xl" x-text="votes.p1"></div>
                    </div>
                </div>

                <div>
                    <div class="flex justify-between mb-2">
                        <span class="font-medium text-white">Pistes Cyclables Séparées (Viaduc)</span>
                        <span class="font-mono text-purple-300">Coût: <span x-text="Math.pow(votes.p2, 2)"></span> crédits</span>
                    </div>
                    <div class="flex items-center gap-4">
                        <input type="range" min="0" max="10" step="1" x-model="votes.p2" @input="checkCredits('p2')" class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer">
                        <div class="w-12 h-12 flex items-center justify-center bg-purple-500/20 border border-purple-500 rounded-lg text-purple-300 font-bold text-xl" x-text="votes.p2"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-span-4 row-span-5 glass-panel p-6 rounded-2xl flex flex-col justify-center items-center relative">
            <div class="absolute top-4 left-4 text-xs font-mono text-gray-400">QUALITÉ AIR (PM2.5)</div>
            
            <div class="relative w-48 h-48">
                <svg class="w-full h-full transform -rotate-90">
                    <circle cx="96" cy="96" r="88" stroke="currentColor" stroke-width="12" fill="transparent" class="text-gray-800" />
                    <circle cx="96" cy="96" r="88" stroke="currentColor" stroke-width="12" fill="transparent" 
                            :stroke-dasharray="circumference" 
                            :stroke-dashoffset="circumference - percent / 100 * circumference" 
                            class="text-neon-red transition-all duration-1000 ease-out" />
                </svg>
                <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-center">
                    <span class="text-5xl font-black text-white" x-text="airValue">42</span>
                    <span class="block text-xs font-mono text-neon-red mt-1">MAUVAISE</span>
                </div>
            </div>
            
            <p class="mt-6 text-center text-xs text-gray-400 max-w-[80%]">
                Donnée brute agrégée depuis 24 capteurs citoyens <span class="text-white underline">Sensor.Community</span>.
            </p>
        </div>

    </main>

    <script>
        function auderghemCore() {
            return {
                authenticated: false,
                loginState: 'INITIALISER LE POD',
                credits: 100,
                votes: { p1: 0, p2: 0 },
                airValue: 42,
                circumference: 88 * 2 * Math.PI,
                
                get percent() {
                    return (this.airValue / 100) * 100;
                },

                // Séquence de Login "Cinématique"
                login() {
                    this.loginState = 'CONNEXION EN COURS...';
                    setTimeout(() => { this.loginState = 'VÉRIFICATION WEBID...'; }, 800);
                    setTimeout(() => { this.loginState = 'DÉCHIFFREMENT DU POD...'; }, 1600);
                    setTimeout(() => {
                        this.authenticated = true;
                        this.initCharts();
                        this.liveDataSimulation();
                    }, 2200);
                },

                // Logique Vote Quadratique (Coût = Voix au carré)
                checkCredits(project) {
                    const costP1 = Math.pow(this.votes.p1, 2);
                    const costP2 = Math.pow(this.votes.p2, 2);
                    const totalCost = costP1 + costP2;

                    if (totalCost > 100) {
                        // Si dépasse le budget, on empêche l'incrémentation
                        this.votes[project]--;
                    }
                    this.credits = 100 - (Math.pow(this.votes.p1, 2) + Math.pow(this.votes.p2, 2));
                },

                // Simulation des capteurs en temps réel
                liveDataSimulation() {
                    setInterval(() => {
                        // Fluctuation Air Quality
                        this.airValue = 40 + Math.floor(Math.random() * 10);
                    }, 3000);
                },

                // Initialisation des graphiques (STIB vs Citoyen)
                initCharts() {
                    // On attend que le DOM soit rendu par Alpine
                    setTimeout(() => {
                        const ctx = document.getElementById('mobilityChart').getContext('2d');
                        
                        // Dégradés futuristes
                        const gradientOfficial = ctx.createLinearGradient(0, 0, 0, 400);
                        gradientOfficial.addColorStop(0, 'rgba(0, 209, 255, 0.5)');
                        gradientOfficial.addColorStop(1, 'rgba(0, 209, 255, 0)');

                        const gradientCitizen = ctx.createLinearGradient(0, 0, 0, 400);
                        gradientCitizen.addColorStop(0, 'rgba(255, 42, 42, 0.5)');
                        gradientCitizen.addColorStop(1, 'rgba(255, 42, 42, 0)');

                        new Chart(ctx, {
                            type: 'line',
                            data: {
                                labels: ['08:00', '08:15', '08:30', '08:45', '09:00', '09:15'],
                                datasets: [
                                    {
                                        label: 'STIB (Théorique)',
                                        data: [2, 3, 2, 4, 3, 2],
                                        borderColor: '#00D1FF',
                                        backgroundColor: gradientOfficial,
                                        borderWidth: 2,
                                        tension: 0.4,
                                        fill: true
                                    },
                                    {
                                        label: 'TELRAAM (Réel)',
                                        data: [5, 12, 18, 15, 9, 6], // La vérité qui dérange
                                        borderColor: '#FF2A2A',
                                        backgroundColor: gradientCitizen,
                                        borderWidth: 2,
                                        borderDash: [5, 5],
                                        tension: 0.4,
                                        fill: true
                                    }
                                ]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: { labels: { color: '#94a3b8', font: { family: 'JetBrains Mono' } } }
                                },
                                scales: {
                                    y: { 
                                        grid: { color: 'rgba(255,255,255,0.05)' },
                                        ticks: { color: '#64748b' }
                                    },
                                    x: { 
                                        grid: { display: false },
                                        ticks: { color: '#64748b' }
                                    }
                                },
                                animation: {
                                    y: { duration: 2000, from: 500 }
                                }
                            }
                        });
                    }, 100);
                },

                bootSystem() {
                    console.log("AUDERGHEM OS /// BOOT SEQUENCE INITIATED");
                }
            }
        }
    </script>
</body>
</html>
